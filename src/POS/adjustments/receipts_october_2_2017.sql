/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
/**
 * Author:  Guinness
 * Created: Oct 2, 2017
 */

select r.receipt_no,r.date_received,ri.date_delivered,count(ri.id) as rows
from receipts r
left join receipt_items ri on r.receipt_no = ri.receipt_no
where r.date_delivered <> ri.date_delivered
group by r.receipt_no
order by r.receipt_no
;

+---------------+---------------+----------------+------+
| receipt_no    | date_received | date_delivered | rows |
+---------------+---------------+----------------+------+
| 14|0000001342 | 2016-04-19    | 2016-05-04     |    1 |
| 14|0000001365 | 2016-05-04    | 2016-05-06     |    5 |
| 14|0000001425 | 2016-12-27    | 2016-06-02     |    3 |
| 14|0000001443 | 2016-08-04    | 2016-06-08     |    6 |
| 14|0000001773 | 2016-12-16    | 2017-08-13     |    1 |
| 14|0000001775 | 2016-12-16    | 2001-12-31     |    1 |
| 14|0000001786 | 2016-12-27    | 2017-06-11     |    2 |
| 14|0000001787 | 2016-12-27    | 2017-06-11     |   16 |
| 14|0000001788 | 2016-12-27    | 2017-06-11     |    1 |
| 14|0000001789 | 2016-12-27    | 2017-06-11     |    1 |
| 14|0000001790 | 2016-12-27    | 2017-06-11     |    3 |
| 14|0000001791 | 2016-12-27    | 2017-06-11     |    2 |
| 14|0000001792 | 2016-12-27    | 2017-06-11     |    1 |
| 14|0000001797 | 2017-01-04    | 2017-01-02     |    4 |
| 14|0000001798 | 2017-01-04    | 2017-01-02     |    4 |
| 14|0000001799 | 2017-01-04    | 2017-01-02     |    2 |
| 14|0000001803 | 2017-01-05    | 2017-01-01     |    1 |
| 14|0000001804 | 2017-01-07    | 2017-01-01     |    2 |
| 14|0000001805 | 2017-01-07    | 2017-01-01     |    1 |
| 14|0000001806 | 2017-01-07    | 2017-01-01     |    1 |
| 16|0000001425 | 2016-12-27    | 2017-06-11     |    1 |
| 16|0000001428 | 2017-01-07    | 2017-01-01     |    1 |
| 20|0000001454 | 2017-01-07    | 2017-01-01     |    1 |
| 23|0000001494 | 2016-12-16    | 2017-08-13     |    2 |
| 23|0000001505 | 2017-01-07    | 2017-01-01     |    3 |
| 23|0000001506 | 2017-01-07    | 2017-01-01     |    3 |
| 23|0000001507 | 2017-01-07    | 2017-01-01     |    1 |
| 23|0000001508 | 2017-01-07    | 2017-01-01     |    1 |
| 23|0000001509 | 2017-01-07    | 2017-01-01     |    2 |
| 23|0000001510 | 2017-01-07    | 2017-01-01     |    1 |
+---------------+---------------+----------------+------+
